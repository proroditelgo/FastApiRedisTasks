# FastApiRedisTasks

### API для добавления и контроля задач. Инструкция к применению:

### Подготовка:
Для начала необходимо создать и активировать виртуальное окружение в корне проекта

Создание(Linux):
```
python3 -m venv venv
```
Активация(Linux):
```
sourse venv/bin/activate
```
---
Далее установка зависимостей:
```
pip install -r requirements.txt
```
---
Далее создание файла для хранения переменных окружения, также в корне проекта, с названием **.env**

В него нужно внести следующие данные:

#### Для создания токена:
```
ALGORITHM=YOUR_ALGORITHM
KEY=YOUR_KEY
```
Алгоритм можно выбрать **HS256**, к примеру.
Ключ необходимо сгенерировать(пример на Linux):
```
openssl rand -base64 32
```
#### Для подключения к Redis:
```
REDIS_HOST=YOUR_HOST
REDIS_PORT=YOUR_PORT
```
>При необходимости нужно указать пароль, в локальной версии я его не использовал
---
### Запуск:
Локально всё работает через **uvicorn**
```
uvicorn app.main:app
```
Можно добавить **--reload**, если нужно внести изменения в код и сразу отследить

---

## Описание работы API
Доступ к документации:
```
http://127.0.0.1:8000/docs
```

### Регистрация и пользователи

**auth/register** - *post* запрос для регистрации пользователя 

**auth/login** - *post* запрос для захода в личный кабинет и получение jwt токена (действует 30 минут)

**auth/logout** - *post* запрос выход из системы и удаление токена из куки

**auth/me** - *get* запрос с аутентификацией для проверки текущей сессии пользователя

### Задачи

**tasks/add_task** - *post* запрос с добавлением задачи, перед добавлением проверяет наличие задачи и подбирает свободный номер для задачи пользователя

**tasks/tasks_count** - *get* запрос для получения количества задач пользователя

**tasks/get_task_by_id** - *get* запрос для получения данных о задаче пользователя по номеру задачи

**tasks/get_all_user_tasks** - *get* запрос для получения списка задач пользователя, передать необходимо количество задач для отображения, при повторной активации выдает следующее количество задач (возможно указание другого количества), при достижении конца списка начинает заново.
Количество просмотренных задач сохраняется в cookie, время жизни в *max_age=600*, в секундах

**tasks/update_task** - *put* запрос для внесения изменений в задачу, поменять можно *title*, *description*, *due_data*, *is_completed*, *priority* 

**tasks/delete_task** - удаляет задачу по номеру задачи

>Все API в задачах сначала проводят аутентификацию пользователя, перед использованием залогиниться

---

### Pytest
Для тестирования необходимо создать пользователя test@test.com с паролем ***test***
Или поменять в **conftest.py** в **authenticated_ac()**

Тестировались не всё api, только добавление задач и получение количества задач

---